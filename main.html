<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Lokatsiya va Raqam</title>
</head>
<body>
  <h2>Lokatsiyani olish uchun tugmani bosing ğŸ‘‡</h2>
  <button onclick="getLocation()">ğŸ“ Lokatsiyani olish</button><br><br>

  <input type="tel" id="phone" placeholder="ğŸ“± Telefon raqamingiz" /><br><br>
  <button onclick="sendData()">ğŸ“¤ Yuborish</button>

  <script>
    let latitude = null, longitude = null;

    function getLocation() {
      navigator.geolocation.getCurrentPosition(
        function (position) {
          latitude = position.coords.latitude;
          longitude = position.coords.longitude;
          document.querySelector("h2").innerText = `âœ… Lokatsiya olindi:\nğŸ“ ${latitude}, ${longitude}`;
        },
        function (error) {
          document.querySelector("h2").innerText = "âŒ Lokatsiyani olishda xatolik: " + error.message;
        }
      );
    }

    function sendData() {
      const phone = document.getElementById("phone").value;

      if (!latitude || !longitude) {
        alert("Avval lokatsiyani oling!");
        return;
      }

      fetch("https://bot-map.onrender.com/send-location", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({
          latitude: latitude,
          longitude: longitude,
          phone_number: phone
        }),
      })
        .then(res => res.json())
        .then(data => alert("âœ… Yuborildi"))
        .catch(err => alert("âŒ Xatolik: " + err));
    }
  </script>
</body>
</html>
